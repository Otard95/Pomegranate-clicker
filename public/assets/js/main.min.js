function cookieGet(e){var s=document.cookie.replace(/ /g,""),a=s.split(";"),o={};for(var t in a){var l=a[t].split("=");o[l[0]]=l[1]}return o[e]}var socket=io();socket.on("hasPlayer",function(e){console.log("[on.hasPlayer] status: "+e.status),e.status?(game.id=cookieGet("pId"),game.me=e.player,game.updateSeeds()):(game.preGame.show(),e.err&&overlay.set(e.title,e.msg))}),socket.on("userCreate",function(e){if(console.log("[userCreate] status: "+e.status),e.status){game.id=e.id,game.me=e.player;var s=new Date;s.setTime(s.getTime()+2592e6);var a="expires="+s.toUTCString();document.cookie="pId="+e.id+";"+a+";path=/",game.preGame.hide(),console.log(game)}else e.err&&game.preGame.msg("bad",e.msg)}),socket.on("buyUpgrade",function(e){console.log("[buyUpgrade] status: "+e.status),e.status&&(game.me=e.player)}),socket.on("click",function(e){game.me=e.player,game.updateSeeds()}),socket.on("kick",function(e){overlay.set("You where kicked!",e.msg),socket.disconnect()});var game={id:null,me:{},clicks:0,clock:null,s:socket,dom:{seeds:null,sps:null,pomegranate:null,updrades:{deseeder:{base:null,lvl:null,cost:null},backyardShrub:{base:null,lvl:null,cost:null},backyardTree:{base:null,lvl:null,cost:null}}},preGame:null,updateSeeds:function(){this.dom.seeds.text(Math.floor(this.me.seeds+this.clicks))},updateSPS:function(){this.dom.sps.text(Math.round(this.me.sps))},init:function(){console.log("init");var e=cookieGet("pId");void 0!==e?socket.emit("hasPlayer",{id:e}):this.preGame.show(),game.dom.pomegranate.click(function(){game.clicks++,game.updateSeeds()}),game.clock=setInterval(function(){0!==game.clicks&&(console.log("clicked: "+game.clicks),game.s.emit("click",{n:game.clicks}),game.clicks=0),game.updateSeeds()},1e3)}};game.preGame={base:null,msgBox:null,input:null,playBtn:null,show:function(){this.base.addClass("show")},hide:function(){this.base.removeClass("show")},msg:function(e,s){this.msgBox.html(s),this.msgBox.removeClass("good bad"),"good"==e?this.msgBox.addClass("good"):this.msgBox.addClass("bad"),this.msgBox.addClass("show")},msgHide:function(){this.msgBox.html(""),this.msgBox.removeClass("show good bad")}};var overlay={base:null,title:null,msg:null,closeBtn:null,set:function(e,s){this.title.html(e),this.msg.html(s),this.show()},show:function(){this.base.addClass("show")},hide:function(){this.base.removeClass("show")}};$(document).ready(function(){game.dom.seeds=$("#seedCounter"),game.dom.sps=$("#spsCounter"),$.each(game.dom.updrades,function(e,s){s.base=$("#"+e),s.lvl=$("#"+e+" > .lvl"),s.cost=$("#"+e+" > .cost")}),game.dom.pomegranate=$("#pomegranate"),game.preGame.base=$(".preGame"),game.preGame.msgBox=$(".preGame > .menuBox > .msgBox"),game.preGame.input=$("#pNameIn"),game.preGame.playBtn=$("#playBtn"),game.preGame.playBtn.click(function(){socket.emit("userCreate",{name:game.preGame.input.val()})}),overlay.base=$(".overlay"),overlay.title=overlay.base.find(".title"),overlay.msg=overlay.base.find(".msg"),overlay.closeBtn=overlay.base.find(".closeBtn"),overlay.base.click(function(e){e.target==this&&overlay.hide()}),overlay.closeBtn.click(function(){overlay.hide()}),game.init()});